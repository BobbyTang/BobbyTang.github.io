
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>BobbyTang Blog</title>
  <meta name="author" content="BobbyTang">

  
  <meta name="description" content="Demand Paging Loading the entire program into memory results in loading the executable code for all options, regardless of whether an option is &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://BobbyTang.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="BobbyTang Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">BobbyTang Blog</a></h1>
  
    <h2>Share more, Gain more.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:BobbyTang.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/23/operating-system-concepts-virtualmemory/">Operating System Concepts - VirtualMemory</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-23T05:43:26+08:00" pubdate data-updated="true">Apr 23<span>rd</span>, 2014</time>
        
           | <a href="/blog/2014/04/23/operating-system-concepts-virtualmemory/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/04/23/operating-system-concepts-virtualmemory/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Demand Paging</h2>

<p>Loading the entire program into memory results in loading the executable code for all options, regardless of whether an option is ultimately selected by the user or not. An alternative strategy is to load pages only as they are needed. This technique is known as <strong>demand paging</strong> and is commonly used in virtual memory systems.</p>

<h2>Page Fault</h2>

<p>A page fault causes the following sequence to occur:</p>

<p><img src="https://farm6.staticflickr.com/5325/13952117776_754a2b4bda.jpg" title="Steps_in_handling_a_page_fault.png" ></p>

<ol>
<li>Trap to the operating system.</li>
<li>Save the user registers and process state.</li>
<li>Determine that the interrupt was a page fault.</li>
<li>Check that the page reference was legal and determine the location of the page on the disk.</li>
<li>Issue a read from the disk to a free frame:

<ol type="a">
<li>Wait in a queue for this device until the read request is serviced.</li>
<li>Wait for the device seek and/or latency time.</li>
<li>Begin the transfer of the page to a free frame.</li>
</ol>
</li>
<li>While waiting, allocate the CPU to some other user (CPU scheduling, optional).</li>
<li>Receive an interrupt from the disk I/O subsystem (I/O completed).</li>
<li>Save the registers and process state for the other user (if step 6 is executed).</li>
<li>Determine that the interrupt was from the disk.</li>
<li>Correct the page table and other tables to show that the desired page is now in memory.</li>
<li>Wait for the CPU to be allocated to this process again.</li>
<li>Restore the user registers, process state, and new page table, and then  resume the interrupted instruction.</li>
</ol>


<h2>Copy-on-Write</h2>

<p>Considering that many child processes invoke the exec() system call immediately after creation, the copying of the parent’s address space may be unnecessary.</p>

<p>Instead, we can use a technique known as <strong>copy-on-write</strong>, which works by allowing the parent and child processes initially to share the same pages. These shared pages are marked as copy-on-write pages, meaning that if either process writes to a shared page, a copy of the shared page is created.</p>

<h2>Page Replacement</h2>

<ol>
<li>Find the location of the desired page on the disk.</li>
<li>Find a free frame:

<ol type="a">
<li>If there is a free frame, use it.</li>
<li>If there is no free frame, use a page-replacement algorithm to select a victim frame.</li>
<li>Write the victim frame to the disk; change the page and frame tables accordingly.</li>
</ol>
</li>
<li>Read the desired page into the newly freed frame; change the page and frame tables.</li>
<li>Restart the user process.</li>
</ol>


<p><strong>Page Replacement Algorithm</strong></p>

<ul>
<li>FIFO Page Replacement</li>
<li>Optimal Page Replacement</li>
<li>LRU Page Replacement</li>
<li>LRU-Approximation Page Replacement</li>
<li>Additional-Reference-Bits Algorithm</li>
<li>Second-Chance Algorithm

<ol type="a">
<li> Enhanced Second-Chance Algorithm</li>
</ol>
</li>
<li>Counting-Based Page Replacement

<ol type="a">
<li> least-frequently-used (LFU) page-replacement algorithm</li>
<li> most-frequently-used (MFU) page-replacement algorithm</li>
</ol>
</li>
</ul>


<h2>Raw I/O</h2>

<p>Some operating systems give special programs the ability to use a disk partition as a large sequential array of logical blocks, without any file-system data structures. This array is sometimes called the raw disk, and I/O to this array is termed <strong>raw I/O</strong>.</p>

<p><strong>Raw I/O</strong> bypasses all the file- system services, such as file I/O demand paging, file locking, prefetching, space allocation, file names, and directories.</p>

<h2>Thrashing</h2>

<p>In fact, look at any process that does not have “enough” frames. If the process does not have the number of frames it needs to support pages in active use, it will quickly page-fault. At this point, it must replace some page. However, since all its pages are in active use, it must replace a page that will be needed again right away. Consequently, it quickly faults again, and again, and again, replacing pages that it must bring back in immediately.</p>

<p>This high paging activity is called <strong>thrashing</strong>. A process is thrashing if it is spending more time paging than executing.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/09/operating-system-concepts-mainmemory/">Operating System Concepts - MainMemory</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-09T07:39:27+08:00" pubdate data-updated="true">Apr 9<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/04/09/operating-system-concepts-mainmemory/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/04/09/operating-system-concepts-mainmemory/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Contiguous Memory Allocation</h2>

<p>Problem:</p>

<p>Both the first-fit and best-fit strategies for memory allocation suffer from <strong>external fragmentation</strong>.</p>

<p>The general approach to avoiding this problem is to break the physical memory into fixed-sized blocks and allocate memory in units based on block size. With this approach, the memory allocated to a process may be slightly larger than the requested memory. The difference between these two numbers is <strong>internal fragmentation</strong> — unused memory that is internal to a partition.</p>

<p>Solution:</p>

<p>One solution to the problem of external fragmentation is <strong>compaction</strong>. The goal is to shuffle the memory contents so as to place all free memory together in one large block. Compaction is possible only if relocation is dynamic and is done at execution time.</p>

<p>Another possible solution to the external-fragmentation problem is to permit the logical address space of the processes to be noncontiguous, thus allowing a process to be allocated physical memory wherever such memory is available.</p>

<h2>Page and Segmentation</h2>

<p><strong>Paging</strong> is a memory-management scheme that permits the physical address space of a process to be noncontiguous. Paging avoids external fragmentation and the need for compaction.</p>

<p><img src="https://farm8.staticflickr.com/7454/13951470216_7af3187c5c.jpg" title="paging_with_TLB" ></p>

<p>The <strong>translation look-aside buffer(TLB)</strong> is associative, high-speed memory. Each entry in the TLB consists of two parts: a key (or tag) and a value. When the associative memory is presented with an item, the item is compared with all keys simultaneously. If the item is found, the corresponding value field is returned.</p>

<p>If the page number is not in the TLB (known as a <strong>TLB miss</strong>), a memory reference to the page table must be made. When the frame number is obtained, we can use it to access memory (Figure 8.11). In addition, we add the page number and frame number to the TLB, so that they will be found quickly on the next reference.</p>

<p><strong>Segmentation</strong> is a memory-management scheme that supports this user view of memory.</p>

<h2>Page Table</h2>

<ul>
<li>hierarchical paging</li>
</ul>


<p>Problem&amp;Solution:</p>

<p>For example, consider a system with a 32-bit logical address space. If the page size in such a system is 4 KB (212), then a page table may consist of up to 1 million entries (232/212). Assuming that each entry consists of 4 bytes, each process may need up to 4 MB of physical address space for the page table alone. Clearly, we would not want to allocate the page table contiguously in main memory. One simple solution to this problem is to divide the page table into smaller pieces. We can accomplish this division in several ways.</p>

<pre><code>$ getconf PAGESIZE
4096
</code></pre>

<ul>
<li>hashed page tables</li>
</ul>


<p>Problem&amp;Solution:</p>

<p>A common approach for handling address spaces larger than 32 bits is to use a <strong>hashed page table</strong>, with the hash value being the virtual page number.</p>

<ul>
<li>inverted page tables</li>
</ul>


<p>Problem&amp;Solution:</p>

<p>Usually, each process has an associated page table. One of the drawbacks of this method is that each page table may consist of millions of entries. These tables may consume large amounts of physical memory just to keep track of how other physical memory is being used.</p>

<p>Drawbacks:</p>

<p>Although this scheme decreases the amount of memory needed to store each page table, it increases the amount of time needed to search the table when a page reference occurs.</p>

<p>Systems that use inverted page tables have difficulty implementing shared memory. Shared memory is usually implemented as multiple virtual addresses (one for each process sharing the memory) that are mapped to one physical address. This standard method cannot be used with inverted page tables; because there is only one virtual page entry for every physical page, one physical page cannot have two (or more) shared virtual addresses.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/02/operating-system-concepts-cpu/">Operating System Concepts - CPU</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-02T06:30:57+08:00" pubdate data-updated="true">Apr 2<span>nd</span>, 2014</time>
        
           | <a href="/blog/2014/04/02/operating-system-concepts-cpu/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/04/02/operating-system-concepts-cpu/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>CPU Scheduling</h2>

<p><strong>CPU scheduling</strong> is the task of selecting a waiting process from the ready queue and allocating the CPU to it. The CPU is allocated to the selected process by the dispatcher.</p>

<h2>Scheduling Criteria</h2>

<ul>
<li>CPU utilization</li>
<li>Throughput</li>
<li>Turnaround time</li>
</ul>


<p>The interval from the time of submission of a process to the time of completion is the turnaround time. <strong>Turnaround time</strong> is the sum of the periods spent waiting to get into memory, waiting in the ready queue, executing on the CPU, and doing I/O.</p>

<ul>
<li>Waiting time</li>
<li>Response time</li>
</ul>


<h2>Scheduling Alogrithm</h2>

<ul>
<li>First-Come, First-Served Scheduling</li>
<li>Shortest-Job-First Scheduling</li>
<li>Priority Scheduling</li>
</ul>


<p>A major problem with priority scheduling algorithms is <strong>indefinite blocking</strong>, or <strong>starvation</strong>.</p>

<p>A solution to the problem of indefinite blockage of low-priority processes is <strong>aging</strong>.</p>

<ul>
<li>Round-Robin Scheduling</li>
<li>Multilevel Queue Scheduling</li>
<li>Multilevel Feedback Queue Scheduling</li>
</ul>


<h2>Multiple-Processor/Multicore Scheduling</h2>

<ul>
<li>Processor Affinity</li>
</ul>


<p>Because of the high cost of invalidating and repopulating caches, most SMP systems try to avoid migration of processes from one processor to another and instead attempt to keep a process running on the same processor. This is known as <strong>processor affinity</strong>.</p>

<p>Some systems — such as Linux — also provide system calls that support hard affinity, thereby allowing a process to specify that it is not to migrate to other processors.</p>

<p>The main-memory architecture of a system can affect processor affinity issues. Recall the knowledge non-uniform memory access (NUMA) mentioned in previous post, in which a CPU has faster access to some parts of main memory than to other parts.</p>

<ul>
<li>Load Balancing</li>
</ul>


<p>Load balancing attempts to keep the workload evenly distributed across all processors in an SMP system. It is important to note that load balancing is typically only necessary on systems where each processor has its own private queue of eligible processes to execute.</p>

<p>There are two general approaches to load balancing: <strong>push migration</strong> and <strong>pull migration</strong>. Linux runs its load-balancing algorithm every 200 milliseconds (push migration) or whenever the run queue for a processor is empty (pull migration).</p>

<ul>
<li>Memory Stall</li>
</ul>


<p>Researchers have discovered that when a processor accesses memory, it spends a significant amount of time waiting for the data to become available. This situation, known as a <strong>memory stall</strong>, may occur for various reasons, such as a <strong>cache miss</strong> (accessing data that are not in cache memory).</p>

<ul>
<li>Virtualization</li>
</ul>


<p>The virtualization software presents one or more virtual CPUs to each of the virtual machines running on the system and then schedules the use of the physical CPUs among the virtual machines.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/25/operating-system-concepts-process-slash-thread/">Operating System Concepts - Process/Thread</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-25T05:57:31+08:00" pubdate data-updated="true">Mar 25<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/03/25/operating-system-concepts-process-slash-thread/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/03/25/operating-system-concepts-process-slash-thread/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Process Control Block</h2>

<p><strong>Process Control Block</strong> (PCB, also called Task Controlling Block, Task Struct, or Switchframe) is a data structure in the operating system kernel containing the information needed to manage a particular process.</p>

<p>Process state. The state may be new, ready, running, waiting, halted, and so on.</p>

<p>Program counter. The counter indicates the address of the next instruction to be executed for this process.</p>

<p>CPU registers. They include accumulators, index registers, stack pointers, and general-purpose registers, plus any condition-code information. Along with the program counter, this state information must be saved when an interrupt occurs, to allow the process to be continued correctly afterward.</p>

<p>CPU-scheduling information. This information includes a process priority, pointers to scheduling queues, and any other scheduling parameters.</p>

<p>Memory-management information. This information may include such information as the value of the base and limit registers, the page tables, or the segment tables, depending on the memory system used by the operating system.</p>

<p>Accounting information. This information includes the amount of CPU and real time used, time limits, account numbers, job or process numbers, and so on.</p>

<p>I/O status information. This information includes the list of I/O devices allocated to the process, a list of open files, and so on.</p>

<h2>Context Switch</h2>

<p>A <strong>context switch</strong> (also sometimes referred to as a process switch or a task switch) is the switching of the CPU (central processing unit) from one process or thread to another.</p>

<p>A <strong>context</strong> is the contents of a CPU&rsquo;s registers and program counter at any point in time.</p>

<p>A <strong>program counter</strong> is a specialized register that indicates the position of the CPU in its instruction sequence and which holds either the address of the instruction being executed or the address of the next instruction to be executed, depending on the specific system.</p>

<p>Context switching can be described in slightly more detail as the kernel (i.e., the core of the operating system) performing the following activities with regard to processes (including threads) on the CPU:</p>

<ol>
<li><p>suspending the progression of one process and storing the CPU&rsquo;s state (i.e., the context) for that process somewhere in memory,</p></li>
<li><p>retrieving the context of the next process from memory and restoring it in the CPU&rsquo;s registers and</p></li>
<li><p>returning to the location indicated by the program counter (i.e., returning to the line of code at which the process was interrupted) in order to resume the process.</p></li>
</ol>


<h3>When to switch?</h3>

<p>Context switches can occur only in kernel mode.</p>

<p><strong>Multitasking</strong> 1.)Preemptive schedulers often configure a timer interrupt to fire when a process exceeds its time slice. 2.)This context switch can be triggered by the process making itself unrunnable, such as by waiting for an I/O or synchronization operation to complete.</p>

<p><strong>Interrupt handling</strong> 1.) Hardware interrupt</p>

<p><strong>User and kernel mode switching</strong> may cause context switch.</p>

<h2>Multithread programing</h2>

<p>Benifits 1.) Responsiveness 2.)Resource sharing 3.) Economy 4.)Scalability</p>

<h2>Multicore Programming</h2>

<p>Concerns 1.) Dividing activities 2.)Balance Data splitting 3.)Data dependency 4.)Testing and debugging</p>

<h2>Multithread Model</h2>

<ul>
<li>Many-to-one model</li>
<li>One-to-one model</li>
</ul>


<p>The nptl(native posix thread library) implementation only uses a 1:1 thread model. The scheduler handles every thread as if it were a process. Therefore only the supported scope is PTHREAD_SCOPE_SYSTEM(Plesae see on Pthread Scheduling label). The default scheduling policy is SCHED_OTHER, which is the default Linux scheduler. The nptl implementation can utilize multiple CPUs.</p>

<ul>
<li>Many-to-many model</li>
<li>Green thread</li>
</ul>


<p>On multi-CPU machines, native threads can run more than one thread simultaneously by assigning different threads to different CPUs. Green threads run on only one CPU.</p>

<p>Green threads, the threads provided by the JVM, run at the user level, meaning that the JVM creates and schedules the threads itself. Therefore, the operating system kernel doesn&rsquo;t create or schedule them. Instead, the underlying OS sees the JVM only as one thread.</p>

<ul>
<li>Light weight process(LWP)
In the traditional meaning of the term, as used in Unix System V and Solaris, a LWP runs in user space on top of a single kernel thread and shares its address space and system resources with other LWPs within the same process.</li>
</ul>


<h2>Pthread Scheduling</h2>

<p>There are two possible contention scopes. PTHREAD_SCOPE_SYSTEM and PTHREAD_SCOPE_PROCESS. They can be set with pthread_attr_setscope(). The scope of a thread can only be specified before the thread is created.</p>

<ul>
<li>PTHREAD_SCOPE_SYSTEM</li>
</ul>


<p>A thread that has a scope of PTHREAD_SCOPE_SYSTEM will content with other processes and other PTHREAD_SCOPE_SYSTEM threads for the CPU.</p>

<ul>
<li>PTHREAD_SCOPE_PROCESS</li>
</ul>


<p>All threads of a process that have a scope of PTHREAD_SCOPE_PROCESS will be grouped together and this group of threads contents for the CPU. If there is a process with 4 PTHREAD_SCOPE_PROCESS threads and 4 PTHREAD_SCOPE_SYSTEM threds, then each of the PTHREAD_SCOPE_SYSTEM threads will get a fifth of the CPU and the other 4 PTHREAD_SCOPE_PROCESS threads will share the remaing fifth of the CPU. How the PTHREAD_SCOPE_PROCESS threads share their fifth of the CPU among themselves is determined by the scheduling policy and the thread&rsquo;s priority.</p>

<h2>Process Creation</h2>

<p>When a process creates a new process, two possibilities exist in terms of execution:</p>

<ol>
<li>The parent continues to execute concurrently with its children.</li>
<li>The parent waits until some or all of its children have terminated.</li>
</ol>


<p>There are also two possibilities in terms of the address space of the new process:</p>

<ol>
<li>The child process is a duplicate of the parent process (it has the same program and data as the parent).</li>
<li>The child process has a new program loaded into it.</li>
</ol>


<p>For example, if <code>clone()</code> is passed the flags <code>CLONE FS</code>, <code>CLONE VM</code>, <code>CLONE SIGHAND</code>, and <code>CLONE FILES</code>, the parent and child tasks will share the same file-system information (such as the current working directory), the same memory space, the same signal handlers, and the same set of open files.</p>

<p>However, if none of these flags is set when <code>clone()</code> is invoked, no sharing takes place, resulting in functionality similar to that provided by the <code>fork()</code> system call.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/10/sql-sybasease-alternative-way-to-support-lead-slash-lag-function/">SQL - SybaseASE - Alternative Way to Support LEAD/LAG Function</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T01:32:05+08:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/03/10/sql-sybasease-alternative-way-to-support-lead-slash-lag-function/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/03/10/sql-sybasease-alternative-way-to-support-lead-slash-lag-function/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There is audit trial requirement that need to be captured into log table these day. But we suffer from the limited function provided by Sybase ASE DB in order to achieve our goals. SybaseASE 12.5 does not support neither analytic function nor row number column, and therefore we have to implement cross comparison by ourselves via basic semantics.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="c1">--create rownum column</span>
</span><span class='line'><span class="k">select</span> <span class="n">rownum</span> <span class="o">=</span> <span class="k">identity</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">*</span> <span class="k">from</span> <span class="o">#</span><span class="n">temp_table</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="mi">1</span><span class="o">=</span><span class="mi">2</span>
</span><span class='line'>
</span><span class='line'><span class="k">insert</span> <span class="k">into</span> <span class="o">#</span><span class="n">temp_table</span>
</span><span class='line'><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="k">table</span> <span class="k">where</span> <span class="n">pid</span> <span class="o">=</span> <span class="o">@</span><span class="n">pid</span>
</span><span class='line'><span class="k">insert</span> <span class="k">into</span> <span class="o">#</span><span class="n">temp_table</span>
</span><span class='line'><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">table_history</span> <span class="k">where</span> <span class="n">pid</span> <span class="o">=</span> <span class="o">@</span><span class="n">pid</span> <span class="k">order</span> <span class="k">by</span> <span class="n">audit_update_date</span> <span class="k">desc</span>
</span><span class='line'>
</span><span class='line'><span class="c1">--use self-join to match the cross rows</span>
</span><span class='line'><span class="k">select</span> <span class="n">a</span><span class="p">.</span><span class="n">rownum</span><span class="p">,</span>
</span><span class='line'>      <span class="k">case</span> <span class="k">when</span> <span class="n">a</span><span class="p">.</span><span class="n">col1</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">col1</span> <span class="k">then</span> <span class="s1">&#39;equal&#39;</span> <span class="k">else</span> <span class="s1">&#39;inequal&#39;</span> <span class="k">end</span>
</span><span class='line'><span class="k">from</span> <span class="o">#</span><span class="n">temp_table</span> <span class="n">a</span> <span class="k">left</span> <span class="k">out</span> <span class="k">join</span> <span class="o">#</span><span class="n">temp_table</span> <span class="n">b</span> <span class="k">on</span> <span class="p">(</span> <span class="n">a</span><span class="p">.</span><span class="n">pid</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">pid</span> <span class="k">and</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">rownum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">rownum</span> <span class="p">)</span>
</span><span class='line'><span class="k">where</span> <span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>In contrast, we also provide oracle version of implementation.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/10/sql-switch-slash-transpose-columns-and-rows/">SQL - Switch/Transpose Columns and Rows</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T00:28:27+08:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/03/10/sql-switch-slash-transpose-columns-and-rows/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/03/10/sql-switch-slash-transpose-columns-and-rows/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In practice, we will meet the requirement to rotate the table including convert cols to rows, convert rows to cols. In this session, I&rsquo;ll produce the solution in common method as well as db-specified features.</p>

<h2>Convert columns to rows</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="c1">--common solution</span>
</span><span class='line'><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="s1">&#39;col_1&#39;</span> <span class="k">as</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">col_1</span> <span class="k">as</span> <span class="n">col_val</span>
</span><span class='line'>  <span class="k">from</span> <span class="k">table</span>
</span><span class='line'>  <span class="k">union</span> <span class="k">all</span>
</span><span class='line'>  <span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span> <span class="k">as</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">col_2</span> <span class="k">as</span> <span class="n">col_val</span>
</span><span class='line'>  <span class="k">from</span> <span class="k">table</span>
</span><span class='line'>  <span class="k">union</span> <span class="k">all</span>
</span><span class='line'>  <span class="p">...</span>
</span><span class='line'><span class="p">)</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="c1">--oracle 11g unpivot query</span>
</span><span class='line'><span class="k">select</span> <span class="o">*</span>
</span><span class='line'><span class="k">from</span> <span class="k">table</span>
</span><span class='line'><span class="n">unpivot</span> <span class="p">(</span>
</span><span class='line'>  <span class="n">col_val</span> <span class="k">for</span> <span class="n">col_name</span> <span class="k">in</span> <span class="p">(</span><span class="n">col_1</span> <span class="k">as</span> <span class="s1">&#39;col_1&#39;</span><span class="p">,</span> <span class="n">col_2</span> <span class="k">as</span> <span class="s1">&#39;col_2&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="k">order</span> <span class="k">by</span> <span class="n">id</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Concert rows to columns</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'>  <span class="c1">--common solution</span>
</span><span class='line'>  <span class="k">select</span> <span class="n">id</span><span class="p">,</span>
</span><span class='line'>      <span class="k">max</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;col_1&#39;</span> <span class="k">then</span> <span class="n">col_val</span> <span class="k">else</span> <span class="k">null</span> <span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="n">col_1</span><span class="p">,</span>
</span><span class='line'>      <span class="k">max</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;col_2&#39;</span> <span class="k">then</span> <span class="n">col_val</span> <span class="k">else</span> <span class="k">null</span> <span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="n">col_2</span><span class="p">,</span>
</span><span class='line'>      <span class="p">...</span>
</span><span class='line'>  <span class="k">from</span> <span class="k">table</span>
</span><span class='line'>  <span class="k">order</span> <span class="k">by</span> <span class="n">id</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'>  <span class="c1">--oracle 11g pivot query</span>
</span><span class='line'>  <span class="k">select</span> <span class="o">*</span>
</span><span class='line'>  <span class="k">from</span> <span class="k">table</span>
</span><span class='line'>  <span class="n">pivot</span> <span class="p">(</span>
</span><span class='line'>      <span class="k">max</span><span class="p">(</span><span class="n">col_val</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_name</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;col_1&#39;</span> <span class="k">as</span> <span class="n">col_1</span><span class="p">,</span><span class="s1">&#39;col_2&#39;</span> <span class="k">as</span> <span class="n">col_2</span><span class="p">)</span>
</span><span class='line'>  <span class="p">)</span>
</span><span class='line'>  <span class="k">where</span> <span class="p">...</span>
</span><span class='line'>  <span class="k">order</span> <span class="k">by</span> <span class="n">id</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Excel pivot table</h2>

<p>For non-sql approaches, we can use excel pivot table. Excel spreadsheets are a great way to pivot and analyze Oracle data, and tools.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/05/operating-system-concepts-terminology/">Operating System Concepts - Terminology</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-05T05:04:59+08:00" pubdate data-updated="true">Mar 5<span>th</span>, 2014</time>
        
           | <a href="/blog/2014/03/05/operating-system-concepts-terminology/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/03/05/operating-system-concepts-terminology/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The aim of this post is to review the crucial terms of operating-system and basic interaction of these underlying components.</p>

<p>Before starting with topic, I am going to reveal why I try to read books of OS related at this point. Let me conclude the reasons, first and foremost, various applications in my daily work encounter issues that are associated with LINUX system, such as buffer size, open file limits and unable to create native threads etc. All of these issues point out to the knowledge of OS. Next, Java performance tuning is always based on the operating system concept, like memory management, cpu utilization etc. Furthermore, including all the design concepts are derived from the solution of common issue inside operating system.</p>

<p>Due to these, it is so encouraged to read and go through operating system concept again that I could be inspired and get everything tied. If there are any findings or association with Java, I will make more explanations and comments linked with definitive resource.</p>

<h2>1.Storage Device Hierarchy</h2>

<p>registers &mdash; > cache &mdash; > main memory (RAM random access memory) &mdash; > electronic disk &mdash; > magnetic disk &mdash; > optical disk &mdash; > magnetic tapes</p>

<p><img src="https://farm4.staticflickr.com/3775/13508587744_aa4be3c238_o.png" title="cpu_cache_hierarchy" alt="Alt text" /></p>

<h2>2.Symmetric Multiprocessing (SMP)</h2>

<p>SMP systems are tightly coupled multiprocessor systems with a pool of homogeneous processors running independently, each processor executing different programs and working on different data and with capability of sharing common resources (memory, I/O device, interrupt system and so on) and connected using a system bus or a crossbar.</p>

<pre><code>$uname -a
Linux [nodename] 2.6.18-348.18.l.e15 #1 SMP [date] x86_64 x86_64 GUN/Linux
</code></pre>

<h2>3.Non-uniform Memory Access (NUMA)</h2>

<p>NUMA is a computer memory design used in multiprocessing, where the memory access time depends on the memory location relative to the processor. Under NUMA, a processor can access its own local memory faster than non-local memory (memory local to another processor or memory shared between processors).</p>

<h3>NUMA collector enhancements</h3>

<ul>
<li>The Parallel Scavenger garbage collector has been extended to take advantage of machines with NUMA (Non Uniform Memory Access) architecture.
The NUMA-aware allocator can be turned on with the <code>-XX:+UseNUMA</code> flag in conjunction with the selection of the Parallel Scavenger garbage collector. The Parallel Scavenger garbage collector is the default for a server-class machine. The Parallel Scavenger garbage collector can also be turned on explicitly by specifying the <code>-XX:+UseParallelGC</code> option.
If you want see the detail, please see <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/vm/performance-enhancements-7.html">oracle official document</a>.</li>
</ul>


<h2>4.Clustering</h2>

<p>Clustering can be structured asymmetrically or symmetrically. In asymmetric clustering, one machine is in hot-standby mode while the other is running the applications. The hot-standby host machine does nothing but monitor the active server. If that server fails, the hot-standby host becomes the active server. In symmetric mode, two or more hosts are running applications and are monitoring each other. This mode is obviously more efficient, as it uses all of the available hardware. It does require that more than one application be available to run.</p>

<p>For example in real-world scenario: The secondary EMS server is hot-standby mode. Two Weblogic servers are symmetric mode and load balance.</p>

<h2>5.Network</h2>

<h3>5.1.local area network (LAN)</h3>

<p>A local area network (LAN) is a computer network that user interconnects computers in a limited area such as a home, school, computer laboratory, or office building using network media.</p>

<h3>5.2.storage-area network(SAN)</h3>

<p>SANs are primarily used to enhance storage devices, such as disk arrays, tape libraries, and optical jukeboxes, accessible to servers so that the devices appear like locally attached devices to the operating system.</p>

<h3>5.3.wide area network (WAN)</h3>

<p>A wide area network (WAN) is a network that covers a broad area (i.e., any telecommunications network that links across metropolitan, regional, or national boundaries) using private or public network transports. WANs are often built using leased lines. WANs can also be built using less costly circuit switching or packet switching methods.</p>

<h2>6.Computing Environments</h2>

<h3>6.1.traditional computing</h3>

<p><strong>Batch systems</strong> processed jobs in bulk, with predetermined input (from files or other sources of data).</p>

<p><strong>Time-sharing</strong> systems used a timer and scheduling algorithms to rapidly cycle processes through the CPU, giving each user a share of the resources. Time-sharing systems are an extension of multiprogramming wherein CPU scheduling algorithms rapidly switch between jobs, thus providing the illusion that all jobs are running concurrently.</p>

<h3>6.2client–Server computing (compute or file server system)</h3>

<p>A <strong>socket</strong> is identified by an IP address concatenated with a port number. Servers implementing specific services (such as telnet, FTP, and HTTP) listen to well-known ports (a telnet server listens to port 23; an FTP server listens to port 21; and a Web, or HTTP, server listens to port 80).</p>

<p>The <strong>remote procedure calls (RPCs)</strong> was designed as a way to abstract the procedure-call mechanism for use between systems with network connections.</p>

<p><strong>Remote method invocation (RMI)</strong> is a Java feature similar to RPCs.</p>

<h3>6.3.peer-to-peer computing</h3>

<h3>6.4.web-based computing</h3>

<h2>7.System Calls</h2>

<p>In computing, a system call is how a program requests a service from an operating system&rsquo;s kernel.
System calls provide an essential interface between a process and the operating system.
System calls can be grouped roughly into six major categories: process control, file manipulation, device manipulation, information maintenance, communications, and protection.</p>

<p>To monitor and trace the system call within the process, we can use strace command in Linux.
Strace is used for debugging and troubleshooting the execution of an executable on Linux environment. It displays the system calls used by the process, and the signals received by the process.</p>

<pre><code>$strace
</code></pre>

<h2>8.Interprocess Communication</h2>

<p>There are two common models of interprocess communication:</p>

<h3>8.1.message-passing model</h3>

<p><strong>Message passing</strong> is useful for exchanging smaller amounts of data, because no conflicts need be avoided.</p>

<p>Message passing may be either blocking or nonblocking— also known as synchronous and asynchronous. 1.)<strong>Blocking send</strong> 2.)<strong>Nonblocking send</strong> 3.)<strong>Blockingreceive</strong> 4.)<strong>Nonblocking receive</strong></p>

<p>Whether communication is direct or indirect, messages exchanged by commu- nicating processes reside in a temporary queue. 1.)<strong>Zero capacity</strong> 2.)<strong>Boundedcapacity</strong> 3.)<strong>Unboundedcapacity</strong></p>

<h3>8.2.shared-memory model</h3>

<p>In the <strong>shared-memory</strong> model, processes use shared memory create and shared memory attach system calls to create and gain access to regions of memory owned by other processes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/01/first-post/">First Post</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-01T11:32:03+08:00" pubdate data-updated="true">Jan 1<span>st</span>, 2014</time>
        
           | <a href="/blog/2014/01/01/first-post/#disqus_thread"
             data-disqus-identifier="http://BobbyTang.github.io/blog/2014/01/01/first-post/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h1>MarkDown Template</h1>

<h2>Blockquotes</h2>

<blockquote><h2>Header inside blockquote</h2>

<ol>
<li> This is the first list item.</li>
<li> This is the second list item.</li>
</ol>


<blockquote><p> This is nested blockquote.</p></blockquote>

<p>Here&rsquo;s some example code:</p>

<pre><code>return shell_exec("echo $input | $markdown_script");
</code></pre></blockquote>

<h2>List</h2>

<p>Markdown supports ordered (numbered) and unordered (bulleted) lists.
Unordered lists use asterisks, pluses, and hyphens — interchangably — as list markers:</p>

<ul>
<li>Red</li>
<li>Green</li>
<li><p>Blue</p></li>
<li><p>Bird</p></li>
<li>McHale</li>
<li>Parish</li>
</ul>


<p>To put a code block within a list item, the code block needs to be indented twice — 8 spaces or two tabs:</p>

<ul>
<li>A list item with a code block:
      <codes goes here with two leading tabs></li>
</ul>


<h2>Code Blocks</h2>

<p>To produce a code block in Markdown, simply indent every line of the block by at least 4 spaces or 1 tab. For example, given this input:</p>

<h2>Horizontal Rules</h2>

<hr />

<hr />

<hr />

<hr />

<hr />

<h2>Links</h2>

<h3>inline links</h3>

<p>This is <a href="http://example.com/" title="Title">an example</a> inline link.
See my <a href="/about/">About</a> page for details.</p>

<h3>reference links</h3>

<p>This is <a href="../images/email.png" title="Optional title attribute">an example</a> reference-style link.</p>

<h3>implicit link</h3>

<p>I get 10 times more traffic from <a href="http://google.com/" title="Google">Google</a> than from
<a href="http://search.yahoo.com/" title="Yahoo Search">Yahoo</a> or <a href="http://search.msn.com/" title="MSN Search">MSN</a>.</p>

<h2>Emphasis</h2>

<p><em>single asterisks</em></p>

<p><em>single underscores</em></p>

<p><strong>double asterisks</strong></p>

<p><strong>double underscores</strong></p>

<p>un<em>frigging</em>believable</p>

<p>*this text is surrounded by literal asterisks*</p>

<h2>Code</h2>

<p>Use the <code>printf()</code> function.
<code>There is a literal backtick (`) here.</code>
Please don&rsquo;t use any <code>&lt;blink&gt;</code> tags.</p>

<h2>Images</h2>

<p><img src="/path/to/img.jpg" title="Optional title" alt="Alt text" /></p>

<p><img src="../images/email.png" title="Optional title attribute" alt="Alt text" /></p>

<h2>Miscellaneous</h2>

<h3>Automatic link</h3>

<p><a href="http://daringfireball.net/projects/markdown/syntax#em">http://daringfireball.net/projects/markdown/syntax#em</a>
<a href="&#x6d;&#97;&#105;&#x6c;&#116;&#x6f;&#58;&#97;&#100;&#100;&#x72;&#101;&#x73;&#x73;&#64;&#x65;&#120;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#99;&#x6f;&#109;">&#x61;&#x64;&#x64;&#114;&#x65;&#115;&#x73;&#x40;&#x65;&#x78;&#97;&#109;&#x70;&#108;&#101;&#46;&#99;&#111;&#x6d;</a></p>

<h3>Blackslash escapes</h3>

<pre><code>\   backslash
`   backtick
*   asterisk
_   underscore
{}  curly braces
[]  square brackets
()  parentheses
#   hash mark
+   plus sign
-   minus sign (hyphen)
.   dot
!   exclamation mark
</code></pre>

<h6>This is an H6</h6>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/books/'>books (5)</a></li>
<li class='category'><a href='/blog/categories/sql/'>sql (2)</a></li>
<li class='category'><a href='/blog/categories/test/'>test (1)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/04/23/operating-system-concepts-virtualmemory/">Operating System Concepts - VirtualMemory</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/09/operating-system-concepts-mainmemory/">Operating System Concepts - MainMemory</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/02/operating-system-concepts-cpu/">Operating System Concepts - CPU</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/25/operating-system-concepts-process-slash-thread/">Operating System Concepts - Process/Thread</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/10/sql-sybasease-alternative-way-to-support-lead-slash-lag-function/">SQL - SybaseASE - Alternative Way to Support LEAD/LAG Function</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - BobbyTang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bobbytang';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
